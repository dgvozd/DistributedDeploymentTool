I borrowed the NDesk.Options source code